<!doctype html>
<html>
<head>
  <title>Bark Parks | Toronto</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=7" ; IE=EmulateIE9/>
  <script type="text/javascript" src="http://api.maps.nokia.com/2.2.4/jsl.js?with=all" charset="utf-8"></script>
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0/zepto.min.js"></script>
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
  <script type="text/javascript" src="/js/authorize.js"></script>
</head>
<body>
  <h1 style="text-align:center;font-family:sans-serif">Toronto's Bark Parks</h1>
<div id="map" style="top:6%;width:99.5%;height:94%;position:absolute;z-index:-1"></div>
<script type="text/javascript">
  var infoBubbles = new nokia.maps.map.component.InfoBubbles(),
      eventType = nokia.maps.dom.Page.browser.touch ? "tap" : "click";
  var map = new nokia.maps.map.Display(document.getElementById('map'), {
    center: [43.670234, -79.386737],
    zoomLevel: 13,
    components: [infoBubbles]
  });
  $.getJSON("/parks", function(parks) {
    _.each(parks.locations, function(location) {
      var marker = new nokia.maps.map.StandardMarker([parseFloat(location.latitude), parseFloat(location.longitude)]);
      marker.addListener(eventType, function(e) {
        var content = ["<h2>",location.name,"</h2>"].join("");
        infoBubbles.openBubble(content, marker.coordinate);
      })
      map.objects.add(marker);
    });
  });
</script>
</body>
</html>

